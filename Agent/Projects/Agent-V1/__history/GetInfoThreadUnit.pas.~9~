unit GetInfoThreadUnit;

interface

uses
System.Classes,TAgentClass;

type
   TMyThread = class(TThread)
   private
   var
     MyAgent : TMyAgent;

   procedure SetResult;

   protected
      procedure Execute; override;

   public
      constructor Create(Suspended: Boolean);
   end;




implementation

//uses frmMain_RtoL; //Unit of the form that will be updated by thread

constructor TMyThread.Create(Suspended: Boolean);
begin
   Inherited Create(Suspended);
   FreeOnTerminate := True;
end;

 procedure TMyThread.SetResult;
 begin
  // frmMain_RtoL.MyAgent1 := MyAgent;
  // frmMain_RtoL.t3_result := 1;

 end;

procedure TMyThread.Execute;
begin
    if Terminated then Exit;

    MyAgent := TMyAgent.Create;
    MyAgent.GetSystemInfo;

    if Terminated then Exit;

    MyAgent.GetSystemHashCode;

    if Terminated then Exit;

    MyAgent.SaveSystemInfoToDll;


   // Synchronize(SetResult);

    Terminate;
    WaitFor;
    Exit;
end;


end.
